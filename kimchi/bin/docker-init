#!/bin/sh

## --- install ---
apt-get update && apt-get -y install curl sudo supervisor

## --- systemctl ---
cp -vf /usr/local/bin/systemctl /bin/systemctl

## --- mockup ---
mkdir -p /run/user
mkdir -p /var/run/libvirt/
touch /var/run/libvirt/libvirt-sock
chmod +x /var/run/libvirt/libvirt-sock

set +e
dpkg -i wok.noarch.deb 2>/dev/null
set -e
apt-get -fy install
set +e
dpkg -i ginger-base.noarch.deb 2>/dev/null
set -e
apt-get -fy install
set +e
dpkg -i ginger.noarch.deb 2>/dev/null
set -e
apt-get -fy install
set +e
dpkg -i kimchi.noarch.deb 2>/dev/null
set -e
apt-get -fy install

## --- config ---
sed -i 's/^#session_timeout = .*/session_timeout = 60/g' /etc/wok/wok.conf

## --- mobile navbar-toggle ---
sed -i 's/data-target="#nav-menu"/data-target=".navbar-collapse"/g' /usr/share/wok/ui/pages/wok-ui.html.tmpl

## --- remove self ---
rm -- "$0"

## EOF
